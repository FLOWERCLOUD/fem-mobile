<!doctype html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="viewport" content="initial-scale=1">
<title>Mobile FEM Example</title>
<!-- Include no catch -->
<script type="text/javascript" src="FemMobile/FemMobile.nocache.js"></script>
<!-- Include interface to fem model -->
<script type="text/javascript" src="rendermodel.js"></script>
<!-- Include device orientation helper -->
<script type="text/javascript" src="device_orientation.js"></script>
<!-- Include meta tag to ensure proper rendering and touch zooming -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Include jQuery Mobile stylesheets -->
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<!-- Include the jQuery library -->
<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<!-- Include the jQuery Mobile library -->
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<!-- Include the application specific stylesheets -->
<link rel="stylesheet" href="fem-mobile.css">
</head>
<body class='main'>
	<div class="ui-body-b" data-role="page">
		<div data-role="header">
			<a href="#popupLogin" data-rel="popup" data-position-to="window" class="ui-btn ui-icon-edit ui-btn-icon-notext ui-corner-all" data-transition="pop">Edit</a>
			<!-- a/#popupLogin -->
			<a href="#infoPanel" class="ui-btn ui-icon-info ui-btn-icon-notext ui-corner-all" data-transition="pop">About</a>
			<!-- a/#infoPanel -->
		</div>
		<!-- div/header -->
		<div data-role="main" class="ui-content">
			<div class="ui-grid-b">
				<div class="ui-block-b" id="legendBlock" style="width: 0%">
					<svg xmlns="http://www.w3.org/2000/svg" class="svg" id="mySVGGuiLegend">		 
				     <g id="svgLegend" />
  		 			</svg>
				</div>
				<div class="ui-block-b" id="graficBlock" viewBox="0 0 10 10">
					<svg xmlns="http://www.w3.org/2000/svg" class="svg" id="mySVGGui">		 
					 <g id="svgElements" />
					 <g id="svgNodes" />
		 			 <g id="svgFixed" />
  					 <g id="svgArrows" />
  					 <g id="svgForce" />  	 	 
				</svg>
				</div>
			</div>
			<!-- /ui-grid-b -->
			<div data-role="panel" class="ui-content" data-display="overlay" id="infoPanel"
				class="ui-panel ui-panel-position-right ui-panel-display-overlay ui-body-b ui-panel-animate ui-panel-open" data-position="right" data-theme="b">
				<div style="padding: 0px 5px;">
					<h3>Mobile FEM Example</h3>
					<a href="https://plus.google.com/u/0/117292523089281814301?rel=author">by Markus Sprunck</a>
					<p />
					This application demonstrates the implementation of a minimal Finite Element Method Simulation running in a web browser and uses device orientation
					signals.
					<p />
					It implements a Constant Strain Triangle (CST) and simulates mechanical stress and displacements.
					<p />
					The forces are created by simulation of gravity or with mouse drags of single nodes. Just click into the model and drag mouse.
					<p>
						You may read more <a
							href="http://www.sw-engineering-candies.com/blog-1/finite-element-method-simulation-running-in-the-browser-and-uses-device-orientation">here</a>
					</p>
				</div>
			</div>
			<!-- /ui-content -->
			<div data-role="popup" id="popupLogin" id="popupDialog" class="ui-corner-all" data-overlay-theme="a" data-theme="b" data-dismissible="true"
				style="max-width: 600px;">
				<form>
					<div style="padding: 10px 20px;">
						<fieldset class="ui-grid-a">
							<div class="ui-block-a" style="margin-bottom: 25px;">
								<label for="select-color-code">Color Code:</label>
								<!-- combobox -->
								<select name="select-native-s" id="select-color-code" data-native-menu="true" data-mini="true">
									<option value="4" selected="true">Delta X</option>
									<option value="5">Delta Y</option>
									<option value="1">Stress X</option>
									<option value="2">Stress Y</option>
									<option value="3">Tau</option>   
								</select>
							</div>
							<!-- <div class="ui-block-a"> -->
							<div class="ui-block-b" style="margin-bottom: 25px;">
								<label for="select-model">Model:</label>
								<!-- combobox -->
								<select name="select-native-s" id="select-model" data-native-menu="true" data-mini="true">
									<option value="Beam">Beam</option>
									<option value="Cantilever">Cantilever</option>
									<option value="Eiffel Tower">Eiffel Tower</option>
								</select>
							</div>
							<!-- <div class="ui-block-b"> -->
							<div class="ui-block-a">
								<label for="gravity-fieldset">Forces:</label>
								<fieldset data-role="controlgroup" id="gravity-fieldset">
									<label for="gravity">Gravity</label> <input type="checkbox" name="favcolor" id="gravity" value="gravity" data-mini="true">
								</fieldset>
							</div>
							<!-- ui-block"> -->
							<div class="ui-block-b">
								<label for="showLegend-fieldset">Show:</label>
								<fieldset data-role="controlgroup" id="showLegend-fieldset">
									<label for="showLegend">Legend</label> <input type="checkbox" name="favcolor" id="showLegend" value="showLegend" data-mini="true">
								</fieldset>
							</div>
							<!-- ui-block"> -->
						</fieldset>
						<!-- /ui-grid-b-->
					</div>
					<!-- <div style="padding:10px 20px;"> -->
				</form>
			</div>
		</div>
	</div>
	<!-- /ui-body-b -->
	<noscript>
		<div
			style="width: 22em; position: absolute; left: 50%; margin-left: -11em; color: red; background-color: white; border: 1px solid red; padding: 4px; font-family: sans-serif">Your
			web browser must have JavaScript enabled in order for this application to display correctly.</div>
	</noscript>
	<script type="text/javascript">
		/**
		 * Global variables 
		 */
		var modelRenderer;

		/**
		 * Called by GWT class Fem_sample.java 
		 */
		function renderModel() {
			if (typeof modelRenderer === "undefined") {
				modelRenderer = new ModelRenderer();
			} else {
				modelRenderer.calculateColorRange();
				modelRenderer.renderModel();
				modelRenderer.renderColorScala();
				$('#gravity').prop('checked', OPTIONS.GRAVITY_ACTIVE).checkboxradio("refresh");
			}
		}

		$('#gravity').click(function() {
			OPTIONS.GRAVITY_ACTIVE = this.checked;
			modelRenderer.gravityChangeHandler();
		});

		$('#select-model').change(function() {
			$("#select-model option:selected").each(function() {
				OPTIONS.MODEL_NAME = $(this).text();
				modelRenderer.modelChangeHandler();
			});
		});

		$('#select-color-code').change(function() {
			$("#select-color-code option:selected").each(function() {
				OPTIONS.COLOR_CODE = this.value;
				fem_runSimulation();
			});
		});

		$('#showLegend').click(function() {
			OPTIONS.SHOW_LEGEND = this.checked;
			$('#legendBlock').width(OPTIONS.SHOW_LEGEND ? "15%" : "0%");
			$('#graficBlock').width(OPTIONS.SHOW_LEGEND ? "85%" : "100%");
			fem_runSimulation();
		});
	</script>
</body>
</html>
